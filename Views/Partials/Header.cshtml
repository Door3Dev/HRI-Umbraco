@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@{
    // Grab a handle to the homepage
    var homePage = CurrentPage.AncestorsOrSelf(1).First();

    // The menu items we want are all of the children of the homepage unless marked hidden
    var menuItems = homePage.Children.Where("navigationVisibility!=15");
                      
}

<div id="header" class="row-fluid">
  <div id="masthead" class="row-fluid">
    <div class="span3">
      <a href="@homePage.Url">
        <div class="logo-sm">
          <h1>Health Republic Insurance</h1>
        </div>
      </a>
    </div>
    <div class="span9">
      <div class="navigation pull-right">
        <ul class="nav-site unstyled inline">
          <li class="menu-item short">			  	
                <a href="@homePage.Url">Home</a>
          </li>
			@foreach (var item in menuItems.Where("navigationVisibility!=13"))
			{
				if(item.Children.Where("navigationVisibility!=15").Count() > 0)
				{
					<li class="dropdown">
					<a href="" data-toggle="dropdown" class="dropdown-toggle">@Html.Raw(item.menuItemName)<span class="caret"></span></a>
					<ul class="dropdown-menu">
							@foreach (var subpage in item.Children)
							{
								if(subpage.NodeTypeAlias == "ExternalFile")
								{
									<li class="sub-link"><a href="@subpage.Field("file")">@Html.Raw(subpage.menuItemName)</a></li>
								}
								else
								{
									<li class="sub-link"><a href="@subpage.Url">@Html.Raw(subpage.menuItemName)</a></li>
								}
							}
					</ul>
					</li> 
				}
				else
				{
					<li>
						<a href="@item.Children.First().Url" class="dropdown-toggle">@Html.Raw(item.menuItemName)</a>
					</li>
				}
			  }                    

        </ul>

      </div>
      <!-- masthead -->

    </div>
  </div>
  <!-- header-row -->
</div>